<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.softlab.okr.dao.SignUpMapper">
  <resultMap id="signUpMap" type="com.softlab.okr.model.entity.SignUp">
    <id property="id" column="id"/>
    <result property="studentId" column="student_id"/>
    <result property="name" column="name"/>
    <result property="gender" column="gender"/>
    <result property="qq" column="qq"/>
    <result property="major" column="major"/>
    <result property="profile" column="profile"/>
    <result property="status" column="status"/>
    <result property="comment" column="comment"/>
    <result property="createTime" column="create_time"/>
    <result property="updateTime" column="update_time"/>
  </resultMap>

  <resultMap id="VoMap" type="com.softlab.okr.model.vo.SignUpVO">
    <result property="studentId" column="student_id"/>
    <result property="name" column="name"/>
    <result property="gender" column="gender"/>
    <result property="qq" column="qq"/>
    <result property="major" column="major"/>
    <result property="profile" column="profile"/>
    <result property="status" column="status"/>
    <result property="comment" column="comment"/>
    <result property="updateTime" column="update_time"/>
  </resultMap>

  <sql id="baseColumn">
    `id`,`student_id`, `name`, `gender`, `qq`, `major`, `profile`, `status`,
    `comment`,`create_time`,`update_time`
  </sql>

  <sql id="VoColumn">
    `student_id`, `name`, `gender`, `qq`, `major`, `profile`, `status`,
    `comment`,`update_time`
  </sql>

  <sql id="table">
    signup
  </sql>

  <insert id="insertSignUp">
    insert into
    <include refid="table"></include>
    (<include refid="baseColumn"></include>)
    values (null,#{studentId}, #{name}, #{gender}, #{qq}, #{major}, #{profile}, 0,null,NOW(),NOW())
  </insert>

  <select id="isExist" parameterType="string" resultType="string">
    select student_id from <include refid="table"></include> where id=#{id} limit 1
  </select>

  <update id="updateSignUp">
    update <include refid="table"></include> set
    `name`=#{name},
    `gender`=#{gender},
    `qq`=#{qq},
    `major`=#{major},
    `profile`=#{profile},
    `status`= #{status},
    `comment`=#{comment},
    `update_time`=NOW()
    where `student_id`=#{studentId}
  </update>

  <select id="selectSignUpByCond" resultMap="VoMap">
    select
    <include refid="VoColumn"></include>
    from
    <include refid="table"></include>
    where 1=1
    <if test="id!='' and id!=null">and student_id=#{studentId}</if>
    <if test="name!='' and name!=null">and `name` like '%${name}%'</if>
    <if test="gender!='' and gender!=null">and gender=#{gender}</if>
    <if test="qq!='' and qq!=null">and `qq` like '%${qq}%'</if>
    <if test="major!='' and major!=null">and major like '%${major}%'</if>
    <if test="status!=null">and status=#{status}</if>
  </select>

  <select id="selectSignUpById" resultMap="VoMap">
    select
    <include refid="VoColumn"></include>
    from
    <include refid="table"></include>
    where `student_id`=#{studentId}
  </select>

  <select id="selectSignUp" resultMap="VoMap">
    select
    <include refid="VoColumn"></include>
    from
    <include refid="table"></include>
  </select>
</mapper>
