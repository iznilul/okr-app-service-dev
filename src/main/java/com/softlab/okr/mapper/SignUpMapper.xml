<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.softlab.okr.mapper.SignUpMapper">
  <resultMap id="signUpMap" type="com.softlab.okr.model.entity.SignUp">
    <id property="id" column="id"/>
    <result property="name" column="name"/>
    <result property="gender" column="gender"/>
    <result property="qq" column="qq"/>
    <result property="major" column="major"/>
    <result property="profile" column="profile"/>
    <result property="status" column="status"/>
    <result property="comment" column="comment"/>
    <result property="createTime" column="create_time"/>
    <result property="updateTime" column="update_time"/>
  </resultMap>

  <sql id="baseColumn">
    `id`, `name`, `gender`, `qq`, `major`, `profile`, `status`, `comment`,`create_time`,`update_time`
  </sql>

  <insert id="insertSignUpList">
    insert into signuplist
    (<include refid="baseColumn"></include>)
    values (#{id}, #{name}, #{gender}, #{qq}, #{major}, #{profile}, 0,null,NOW(),NOW())
    on duplicate key update
    `name`=#{name},
    `gender`=#{gender},
    `qq`=#{qq},
    `major`=#{major},
    `profile`=#{profile},
    `status`= 0,
    `comment`=null,
    `update_time`=NOW()
  </insert>

  <select id="selectSignUpListStatus" parameterType="string"
    resultType="com.softlab.okr.model.vo.SignUpVO">
        select status,comment from signuplist where id=#{id}
    </select>

  <select id="isExist" parameterType="string" resultType="string">
        select id from signuplist where id=#{id} limit 1
    </select>

  <update id="updateSignUpList">
        update `signuplist` set
        `name`=#{name},
        `gender`=#{gender},
        `qq`=#{qq},
        `major`=#{major},
        `profile`=#{profile},
        `status`= #{status},
        `comment`=#{comment},
        `update_time`=NOW()
        where `id`=#{id}
   </update>

  <select id="selectSignUpListByCond" resultMap="signUpMap">
    select
    <include refid="baseColumn"></include>
    from signuplist
    where 1=1
    <if test="id!='' and id!=null">and id=#{id}</if>
    <if test="name!='' and name!=null">and `name` like '%${name}%'</if>
    <if test="gender!='' and gender!=null">and gender=#{username}</if>
    <if test="qq!='' and qq!=null">and `qq` like '%${qq}%'</if>
    <if test="major!='' and major!=null">and major like '%${major}%'</if>
    <if test="status!=null">and status=#{status}</if>
  </select>

  <select id="selectSignUpListById" resultMap="signUpMap">
    select
    <include refid="baseColumn"></include>
    from signuplist
    where `id`=#{id}
  </select>

  <select id="selectSignUpList" resultMap="signUpMap">
    select
    <include refid="baseColumn"></include>
    from signuplist
  </select>
</mapper>
